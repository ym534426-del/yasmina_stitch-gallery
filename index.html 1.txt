import React, { useState, useEffect, useMemo, useCallback } from 'react';
// ุงุณุชุฎุฏุงู ููุชุจุฉ lucide-react ูุฃููููุงุช ุงูููุจ
import { Sun, Moon, Instagram, MessageSquare, Menu, X, CheckCircle, Image, Heart } from 'lucide-react';

// -------------------------------------------------------------------------
// 1. ุชุนุฑูู ุจูุงูุงุช ุงูููุชุฌุงุช (Gallery Data Structure)
// -------------------------------------------------------------------------

// ูุงุฆูุฉ ุงูููุชุฌุงุช ูุน ุฃููููุงุชูุง ุงูุชุนุจูุฑูุฉ ููุง ุทูุจุชู
const PRODUCTS = [
  { id: 'newborn', name: 'ุทุงุฑุงุช ููููุฏ', color: 'text-sky-500', icon: '๐', slug: 'newborn-hoops' },
  { id: 'wedding', name: 'ููุงุฏูู ูุชุจ ูุชุงุจ', color: 'text-gray-300', icon: '๐ค', slug: 'wedding-handkerchiefs' },
  { id: 'cartoon', name: 'ุทุงุฑุงุช ูุฑุชูููุฉ', color: 'text-orange-400', icon: '๐งก', slug: 'cartoon-hoops' },
  { id: 'quranic', name: 'ุทุงุฑุงุช ูุจุฑุงููุฒ ุขูุงุช ูุฑุขููุฉ', color: 'text-emerald-600', icon: '๐', slug: 'quranic-art' },
  { id: 'socks', name: 'ุชุทุฑูุฒ ุนูู ุดุฑุงุจุงุช', color: 'text-purple-500', icon: '๐', slug: 'embroidered-socks' },
  { id: 'wanas', name: 'ููููุณ', color: 'text-red-500', icon: 'โค๏ธ', slug: 'wanas-collection' },
  { id: 'memories', name: 'ุฐูุฑู ุฌูููุฉ ููุตูุฑ', color: 'text-amber-700', icon: '๐ค', slug: 'photo-memories' },
];

// ุจูุงูุงุช ููููุฉ ููุตูุฑ ุฏุงุฎู ูู ูุนุฑุถ (ููุชูุถูุญ)
const GALLERY_IMAGES = {
  'newborn': [
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-12_17-38-59.jpg",
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-12_18-38-12.jpg",
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-12_18-34-20.jpg",
  ],
  // ** ุชู ุชุญุฏูุซ 'wedding' ุจุงูุฑูุงุจุท ุงูุญููููุฉ ุงูุชู ุฃุฑุณูุชููุง **
  'wedding': [
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-12_19-21-57.jpg",
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-12_19-21-58.jpg",
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-12_19-22-00.jpg",
  ],
  // ** ุชู ุชุญุฏูุซ 'cartoon' ุจุงูุฑูุงุจุท ุงูุญููููุฉ ุงูุชู ุฃุฑุณูุชููุง **
  'cartoon': [
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-13_02-10-54.jpg",
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-13_02-10-58.jpg",
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-09_19-54-12.jpg",
  ],
  // ** ุชู ุชุญุฏูุซ 'quranic' ุจุงูุฑูุงุจุท ุงูุญููููุฉ ุงูุชู ุฃุฑุณูุชููุง **
  'quranic': [
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-13_01-26-50.jpg",
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-13_01-26-51.jpg",
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-13_01-26-42.jpg",
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-12_18-34-18.jpg",
  ],
  // ** ุชู ุชุญุฏูุซ 'socks' ุจุงูุฑูุงุจุท ุงูุญููููุฉ ุงูุชู ุฃุฑุณูุชููุง (7 ุตูุฑ) **
  'socks': [
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-13_02-33-01.jpg",
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-13_02-33-04.jpg",
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-13_02-33-07.jpg",
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-13_02-33-10.jpg",
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-13_02-33-14.jpg",
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-13_02-33-17.jpg",
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-13_02-33-20.jpg",
  ],
  // ** ุชู ุชุญุฏูุซ 'wanas' ุจุงูุฑูุงุจุท ุงูุญููููุฉ ุงูุชู ุฃุฑุณูุชููุง **
  'wanas': [
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-12_18-34-17.jpg",
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-13_02-10-57.jpg",
  ],
  // ** ุชู ุฅุฒุงูุฉ Placeholder ูู 'memories' **
  'memories': [
    "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/photo_2025-11-13_02-10-55.jpg",
  ],
};

// -------------------------------------------------------------------------
// 2. ุงูููููุงุช ุงููุณุงุนุฏุฉ (Helper Components)
// -------------------------------------------------------------------------

// ** ูููู ูุงูุฐุฉ ุนุฑุถ ุงูุตูุฑุฉ ุงูููุจุฑุฉ (Lightbox Modal) **
const LightboxModal = ({ imageUrl, onClose }) => {
  // ุฅุบูุงู ุนูุฏ ุงูุถุบุท ุนูู ููุชุงุญ ESC
  useEffect(() => {
    const handleKeydown = (e) => {
      if (e.key === 'Escape') {
        onClose();
      }
    };
    window.addEventListener('keydown', handleKeydown);
    return () => window.removeEventListener('keydown', handleKeydown);
  }, [onClose]);

  if (!imageUrl) return null;

  return (
    // ุญุงููุฉ ุงูููุฏุงู (ุงูุฎูููุฉ ุงูุฏุงููุฉ) - z-[100] ูุถูุงู ุงูุธููุฑ ููู ูู ุดูุก
    <div
      className="fixed inset-0 z-[100] flex items-center justify-center p-4 bg-brown-dark/95 backdrop-blur-sm transition-opacity duration-300"
      onClick={onClose} // ุฅุบูุงู ุนูุฏ ุงูุถุบุท ุนูู ุงูุฎูููุฉ
      dir="rtl"
    >
      {/* ุญุงููุฉ ุงูุตูุฑุฉ ููุณูุง - ุชูููู ุงูุชูุฑูุฑ ุงูุชููุงุฆู (overflow-auto) ูุชุญุฏูุฏ ุฃูุตู ุงุฑุชูุงุน (max-h-[95vh]) ููุณูุงุญ ุจุงูุชูุฑูุฑ ุฏุงุฎู ุงูุฅุทุงุฑ ุงููุชุงุญ */}
      <div
        className="relative max-w-6xl w-full max-h-[95vh] overflow-auto rounded-xl shadow-2xl transform scale-100 transition-transform duration-300"
        onClick={(e) => e.stopPropagation()} // ููุน ุฅุบูุงู ุงูููุฏุงู ุนูุฏ ุงูุถุบุท ุนูู ุงูุตูุฑุฉ
      >
        <img
          src={imageUrl}
          alt="ุตูุฑุฉ ููุจุฑุฉ"
          // object-contain: ูุถูุงู ุฃู ุงูุตูุฑุฉ ุชุธูุฑ ูุงููุฉ (ุบูุฑ ููุทูุนุฉ) ุถูู ุงูุญุงููุฉ ุงููุงุจูุฉ ููุชูุฑูุฑ
          className="w-full h-auto object-contain" 
          onError={(e) => {
            e.target.onerror = null;
            e.target.src = `https://placehold.co/1000x1000/ff6666/ffffff?text=ูุดู+ุชุญููู+ุงูุตูุฑุฉ`;
          }}
        />

        {/* ุฒุฑ ุงูุฅุบูุงู */}
        <button
          onClick={onClose}
          className="absolute top-4 left-4 p-3 rounded-full bg-off-white/80 dark:bg-brown-dark/80 text-brown-dark dark:text-off-white shadow-lg hover:bg-accent-1 hover:text-white transition-all duration-300"
          aria-label="ุฅุบูุงู ุงูุตูุฑุฉ ุงูููุจุฑุฉ"
        >
          <X size={24} />
        </button>
      </div>
    </div>
  );
};


// ูููู ุจุทุงูุฉ ุงูููุชุฌ ูู ุตูุญุฉ ุงูููุฑุณ
const ProductCard = ({ product, onClick }) => (
  <button
    onClick={() => onClick(product.id)}
    className="group bg-coffee/50 dark:bg-brown-dark/50 p-6 rounded-xl shadow-lg hover:shadow-2xl transition-all duration-300 transform hover:scale-[1.02] border-4 border-transparent hover:border-accent-2"
  >
    <div className={`text-4xl mb-4 ${product.color}`}>{product.icon}</div>
    <h3 className="text-xl font-extrabold text-brown-dark dark:text-off-white group-hover:text-accent-1 transition-colors">
      {product.name}
    </h3>
    <p className="mt-2 text-sm text-coffee-dark dark:text-off-white/80">
      ุชุตูุญ ูุนุฑุถ ุตูุฑ {product.name} ุงููุทุฑุฒุฉ.
    </p>
  </button>
);

// ูููู ูุนุฑุถ ุงูุตูุฑ (ูุนุฑุถ ุตูุฑ ูุฑุจุนุฉ 1:1)
// ุชู ุฅุถุงูุฉ ุฏุงูุฉ openModal ูุฎุงุตูุฉ ุฌุฏูุฏุฉ
const GalleryGrid = ({ images, openModal }) => (
  <div className="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 md:gap-6">
    {images.map((url, index) => (
      <div 
        key={index} 
        onClick={() => openModal(url)} // ** ุชู ุฅุถุงูุฉ ุฏุงูุฉ ุงููุชุญ ููุง **
        className="aspect-square w-full rounded-lg overflow-hidden shadow-lg border-4 border-off-white dark:border-brown-dark cursor-pointer transition-shadow hover:shadow-accent-1/50"
      >
        <img
          src={url}
          alt={`ุตูุฑุฉ ุชุทุฑูุฒ ุฑูู ${index + 1}`}
          className="w-full h-full object-cover transition-transform duration-500 hover:scale-110"
          onError={(e) => {
            e.target.onerror = null;
            // ุงุณุชุฎุฏุงู Placeholder ูู ุญุงู ูุดู ุชุญููู ุงูุตูุฑุฉ
            e.target.src = `https://placehold.co/500x500/696969/ffffff?text=ุตูุฑุฉ+ุบูุฑ+ูุชููุฑุฉ`;
          }}
        />
      </div>
    ))}
  </div>
);

// ูููู ุฒุฑ ุงูุชูุงุตู
const ContactButton = ({ icon: Icon, label, href, bgColor }) => (
  <a
    href={href}
    target="_blank"
    rel="noopener noreferrer"
    className={`flex items-center justify-center gap-3 p-4 rounded-full font-bold shadow-xl transition-all duration-300 hover:scale-105 ${bgColor} text-white`}
  >
    <Icon size={24} />
    <span className="hidden sm:inline-block">{label}</span>
  </a>
);

// -------------------------------------------------------------------------
// 3. ููููุงุช ุงูุฃูุณุงู ุงูุฑุฆูุณูุฉ (Main Sections)
// -------------------------------------------------------------------------

// ุชู ุชุญุฏูุซ ุงูุฑุงุจุท ุงูุงูุชุฑุงุถู ููุดุนุงุฑ ููุง:
const LOGO_URL = "https://raw.githubusercontent.com/ym534426-del/yasmina-stitch/refs/heads/main/Gemini_Generated_Image_gs6vspgs6vspgs6v.png";

const HeroSection = ({ logoUrl = LOGO_URL }) => (
  <section id="hero" className="min-h-[70vh] flex flex-col items-center justify-center text-center p-8 bg-off-white dark:bg-brown-dark transition-colors">
    <div className="mb-8">
      {/* ููุงู ุงูุดุนุงุฑ (Logo) */}
      <img
        src={logoUrl}
        alt="ุดุนุงุฑ ูุงุณูููุง ุณุชูุชุด"
        // ** ุงูุชุนุฏูู ููุง: ุชู ุชุบููุฑ rounded-xl ุฅูู rounded-full **
        className="w-32 h-32 md:w-40 md:h-40 rounded-full border-8 border-coffee dark:border-off-white/20 shadow-2xl transition-transform duration-500 hover:scale-110 object-cover"
        onError={(e) => {
          e.target.onerror = null;
          e.target.src = "https://placehold.co/150x150/8B4513/FFFFFF?text=YS+Logo";
        }}
      />
    </div>

    <h1 className="text-4xl md:text-6xl font-black text-brown-dark dark:text-off-white mb-4">
      Yasmina Stitch
    </h1>

    <p className="max-w-xl text-xl md:text-2xl font-light text-coffee-dark dark:text-off-white/90 leading-relaxed italic">
      ุชุทุฑูุฒ ูุฏูู ุจุชูุงุตูู ุฏุงูุฆุฉ ููููุฒุฉ ุตููุนุช ุจูู ุญุจ ๐ค
    </p>
    <p className="max-w-xl text-lg md:text-xl mt-4 text-coffee-dark dark:text-off-white/70 leading-relaxed border-b-2 border-accent-2 pb-4">
      ูุชุงุญ ุชูููุฐ ุงูุฃููุงุฑ ุงููู ุชุญุจููุง ุงุจุนุชูููุง ุฑุณุงูุฉ ููุฑุชุจูุง ุณูุง ุจุงูุฎููุท ๐ค
    </p>

    <div className="mt-8 flex gap-4">
      <ContactButton
        icon={MessageSquare}
        label="ุฑุณุงูุฉ ูุงุชุณุงุจ"
        href="https://wa.me/201152205148"
        bgColor="bg-green-500 hover:bg-green-600"
      />
      <ContactButton
        icon={Instagram}
        label="ุงูุณุชุฌุฑุงู"
        href="https://www.instagram.com/yasmina_stitch"
        bgColor="bg-pink-600 hover:bg-pink-700"
      />
    </div>

  </section>
);

const AboutSection = () => (
  <section id="about" className="py-20 px-4 md:px-10 text-center bg-coffee/10 dark:bg-brown-dark/70 transition-colors">
    <h2 className="text-3xl md:text-4xl font-bold text-brown-dark dark:text-off-white mb-6 border-b-4 border-accent-1 inline-block pb-2">
      Yasmina Stitch ุจุชูุฏูู ุฅููุ
    </h2>
    <p className="max-w-3xl mx-auto text-lg md:text-xl text-coffee-dark dark:text-off-white/80">
      ูุญู ูุญูู ุงูุฎููุท ูุงูุฃููุดุฉ ุฅูู ูุตุต ุฎุงูุฏุฉุ ููุชููู ุจุฃุฏู ุงูุชูุงุตูู ูุงุจุชูุงุฑ ูุทุน ูููุฉ ูุฑูุฏุฉ ุชูุงุณุจ ุฌููุน ุงูููุงุณุจุงุช ูุชุฏูู ุทูููุงู. ููุง ุณุชุฌุฏูู ูุฌููุนุชูุง ุงููุชููุนุฉ ุงููุตููุนุฉ ุฎุตูุตูุง ูุชูุจูุฉ ุฐูููู ุงูุฑููุน.
    </p>
  </section>
);

const ProductsIndexSection = ({ setCurrentView }) => (
  <section id="products" className="py-20 px-4 md:px-10 bg-off-white dark:bg-brown-dark transition-colors">
    <h2 className="text-center text-3xl md:text-4xl font-bold text-brown-dark dark:text-off-white mb-12">
      ุงุณุชูุดูู ูุฌููุนุงุชูุง ุงููุชููุฒุฉ
    </h2>
    <div className="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8 text-center">
      {PRODUCTS.map((product) => (
        <ProductCard key={product.id} product={product} onClick={setCurrentView} />
      ))}
    </div>
  </section>
);

// ** ุชู ุชุนุฏูู ูููู ุตูุฏูู ูุดุงุฑูุฉ ุงูุฐูุฑู ููุตุจุญ ููุง ุทูุจุชู ุชูุงูุงู **
const MemoryPromptBox = () => (
  <section className="py-12 px-4 md:px-10 bg-coffee/20 dark:bg-brown-dark/50 transition-colors text-center">
    <div className="max-w-xl mx-auto p-8 rounded-xl border-4 border-accent-1 dark:border-accent-2 shadow-2xl bg-off-white dark:bg-brown-dark/70">
      <h3 className="text-2xl font-bold text-brown-dark dark:text-off-white mb-6">
        ุดุงุฑููุง ููุน ุงูุฐูุฑู ุงููู ุชุญุจ ุชููู ุนูุฏู ูู yasmina stitch ๐ค
      </h3>
      
      {/* ูุฐุง ุฒุฑ ุชูุงุนูู ููุฌู ูุจุงุดุฑุฉ ูููุงุชุณุงุจ */}
      <a
        href="https://wa.me/201152205148?text=ูุฑุญุจุงู%20%D9%8A%D8%A7%20%D9%8A%D8%A7%D8%B3%D9%85%D9%8A%D9%86%D8%A7%20%D8%B3%D8%AA%D9%8A%D8%AA%D8%B4%2C%20%D8%A3%D8%B1%D8%BA%D8%A8%20%D9%81%D9%8A%20%D8%AA%D9%86%D9%81%D9%8A%D8%B0%20%D8%B0%D9%83%D8%B1%D9%89%20%D8%AE%D8%A7%D8%B5%D8%A9%20%D9%84%D9%80..."
        target="_blank"
        rel="noopener noreferrer"
        className="mt-4 inline-block w-full py-3 rounded-lg bg-accent-1 text-white font-bold transition-all duration-300 hover:bg-accent-2 hover:scale-[1.01] shadow-lg"
      >
        ุฅุฑุณุงู ุงูููุฑุฉ ุนุจุฑ ูุงุชุณุงุจ
      </a>
      <p className="text-xs mt-3 text-coffee-dark/70 dark:text-off-white/60">
        ุณูุชู ุชูุฌูููู ูุจุงุดุฑุฉ ููุชุญ ูุญุงุฏุซุฉ ูุงุชุณุงุจ
      </p>
    </div>
  </section>
);


const ProductGallerySection = ({ currentView, setCurrentView, openModal }) => {
  const product = PRODUCTS.find(p => p.id === currentView);
  const images = GALLERY_IMAGES[currentView] || [];

  if (!product) {
    return <div className="text-center p-20 text-red-500 dark:text-red-300">ุฎุทุฃ ูู ุชุญููู ุงููุนุฑุถ.</div>;
  }

  return (
    <section className="py-12 md:py-20 px-4 md:px-10 min-h-screen bg-off-white dark:bg-brown-dark transition-colors">
      <div className="flex items-center justify-between mb-8">
        <button
          onClick={() => setCurrentView('home')}
          className="flex items-center gap-2 text-coffee-dark dark:text-off-white hover:text-accent-1 dark:hover:text-accent-2 font-bold transition-colors text-lg"
        >
          <X size={20} className="transform rotate-45" />
          ุงูุนูุฏุฉ ููููุชุฌุงุช
        </button>
        <h2 className={`text-4xl md:text-5xl font-black ${product.color} border-b-4 border-accent-1 pb-2`}>
          {product.icon} {product.name}
        </h2>
      </div>

      <div className="max-w-7xl mx-auto">
        {images.length > 0 ? (
          <GalleryGrid images={images} openModal={openModal} />
        ) : (
          <div className="text-center p-16 bg-coffee/20 dark:bg-brown-dark/90 rounded-xl">
            <Image size={48} className="mx-auto text-coffee-dark dark:text-off-white mb-4" />
            <p className="xl text-brown-dark dark:text-off-white">
              ูุง ุชูุฌุฏ ุตูุฑ ูุชุงุญุฉ ุญุงูููุง ููุฐุง ุงููุณู. ุณูุชู ุฅุถุงูุฉ ุงูุฃุนูุงู ูุฑูุจุงู!
            </p>
          </div>
        )}
      </div>
    </section>
  );
};

// ูููู ุงูุชุฐููู (Footer)
const Footer = () => (
  <footer className="bg-coffee-dark dark:bg-brown-dark text-off-white py-10 px-4 transition-colors">
    <div className="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center text-center md:text-right">
      <div className="mb-6 md:mb-0">
        <h3 className="text-2xl font-black text-accent-1 mb-2">Yasmina Stitch</h3>
        <p className="text-sm">
          ุชุทุฑูุฒ ูุฏูู ุจุฃุฏู ุงูุชูุงุตูู. ุฌููุน ุงูุญููู ูุญููุธุฉ &copy; {new Date().getFullYear()}
        </p>
      </div>

      <div className="flex flex-col gap-4 items-center md:items-start">
        <h4 className="text-lg font-bold text-accent-2">ุฑูุงุจุท ุณุฑูุนุฉ</h4>
        <div className="flex gap-4">
          <ContactButton
            icon={MessageSquare}
            label="ูุงุชุณุงุจ"
            href="https://wa.me/201152205148"
            bgColor="bg-green-600 hover:bg-green-500 p-2"
          />
          <ContactButton
            icon={Instagram}
            label="ุงูุณุชุฌุฑุงู"
            href="https://www.instagram.com/yasmina_stitch"
            bgColor="bg-pink-700 hover:bg-pink-600 p-2"
          />
        </div>
        <p className="text-xs mt-2 text-off-white/70">
          <CheckCircle size={14} className="inline-block ml-1" />
          ุตููุน ุจุชูุงุตูู ุฏุงูุฆุฉ
        </p>
      </div>
    </div>
  </footer>
);

// -------------------------------------------------------------------------
// 4. ุงููููู ุงูุฑุฆูุณู (App Component)
// -------------------------------------------------------------------------

const App = () => {
  // ุญุงูุฉ ุงูุชุญูู ูู ูุถุน ุงูุนุฑุถ (Light/Dark Mode)
  const [isDarkMode, setIsDarkMode] = useState(() => {
    // ุงูุชุญูู ูู ุงูุฅุนุฏุงุฏุงุช ุงูููุถูุฉ ูููุณุชุฎุฏู ุฃู ุงูุชุฎุฒูู ุงููุญูู
    if (typeof window !== 'undefined' && window.localStorage.getItem('theme') === 'dark') {
      return true;
    }
    return false;
  });

  // ุญุงูุฉ ุงูุชุญูู ูู ุนุฑุถ ุงูุตูุญุฉ ุงูุญุงููุฉ
  const [currentView, setCurrentView] = useState('home'); // 'home' or a product ID
  
  // ** ุฌุฏูุฏ: ุญุงูุฉ ุงูุชุญูู ูู ูุงูุฐุฉ ุงูุนุฑุถ ุงูููุจุฑุฉ (Lightbox) **
  const [selectedImage, setSelectedImage] = useState(null); 
  const [isModalOpen, setIsModalOpen] = useState(false);

  // ุฏุงูุฉ ููุชุญ ุงููุงูุฐุฉ ุงูููุจุฑุฉ
  const openModal = useCallback((url) => {
    setSelectedImage(url);
    setIsModalOpen(true);
  }, []);

  // ุฏุงูุฉ ูุฅุบูุงู ุงููุงูุฐุฉ ุงูููุจุฑุฉ
  const closeModal = useCallback(() => {
    setSelectedImage(null);
    setIsModalOpen(false);
  }, []);


  // ุชุทุจูู ูุถุน ุงูุนุฑุถ ุนูู ุงูู HTML
  useEffect(() => {
    const root = document.documentElement;
    if (isDarkMode) {
      root.classList.add('dark');
      root.style.backgroundColor = '#4A2B1A'; // ุฎูููุฉ ุฏุงููุฉ ุฑุฆูุณูุฉ
      window.localStorage.setItem('theme', 'dark');
    } else {
      root.classList.remove('dark');
      root.style.backgroundColor = '#F8F4E8'; // ุฎูููุฉ ูุงุชุญุฉ ุฑุฆูุณูุฉ
      window.localStorage.setItem('theme', 'light');
    }
  }, [isDarkMode]);

  // ุฏุงูุฉ ุชุจุฏูู ุงููุถุน (Light/Dark)
  const toggleDarkMode = () => setIsDarkMode(prev => !prev);

  // ุฏุงูุฉ ุงูุชุจุฏูู ุฅูู ูุณู ูุนูู ูู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
  const scrollToSection = (sectionId) => {
    setCurrentView('home');
    setTimeout(() => {
      const section = document.getElementById(sectionId);
      if (section) {
        section.scrollIntoView({ behavior: 'smooth' });
      }
    }, 100);
  };

  // -----------------------------------------------------------------------
  // ุชูุณููุงุช Tailwind ุงููุฎุตุตุฉ ููุฎุทูุท ูุงูุฃููุงู (Custom Colors & Fonts)
  // -----------------------------------------------------------------------
  // ุชู ุชุทุจูู ุงูุฎุทูุท ูุงูุฃููุงู ุงูุฏุงูุฆุฉ ุจุงุณุชุฎุฏุงู Tailwind
  // ููุงุญุธุฉ: ุงูุฎุทูุท (Cairo/Almarai) ุชูุญูู ุนุงุฏุฉู ูู ููู CSS ุฎุงุฑุฌู ุฃู CDN
  // ููู ููุง ุณูุถูู ุชุนุฑููุงุช CSS ูุถูุงู ุชุทุจูููุง ุนูู ุงูุฃูู ุจุงูุฎุทูุท ุงูุจุฏููุฉ

  const CustomStyles = () => (
    <style>
      {`
        /* ุชุญููู ุฎุท Cairo ูู Google Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@200..1000&display=swap');

        /* ุชุทุจูู ุฎุท Cairo ุนูู ูุงูู ุงูุชุทุจูู */
        * {
          font-family: 'Cairo', 'Inter', sans-serif;
          direction: rtl; /* ุถูุงู ุงุชุฌุงู ุงููุต ูู ุงููููู ูููุณุงุฑ */
        }

        /* ุชุนุฑูู ุงูุฃููุงู ุงูุฏุงูุฆุฉ ุงููุฎุตุตุฉ ูู Tailwind */
        .bg-off-white { background-color: #F8F4E8; } /* ุฃูู ูุงูุช / ุจูุฌ ูุงุชุญ */
        .text-off-white { color: #F8F4E8; }
        .bg-coffee { background-color: #D2B48C; } /* ูุงููู ูุงุชุญ */
        .text-coffee { color: #D2B48C; }
        .bg-coffee-dark { background-color: #8B4513; } /* ุจูู ุฏุงูู / Mocha */
        .text-coffee-dark { color: #8B4513; }
        .bg-brown-dark { background-color: #4A2B1A; } /* ุจูู ุฏุงูู ุฌุฏุงู / ุงูุดููููุงุชุฉ */
        .text-brown-dark { color: #4A2B1A; }
        .bg-accent-1 { background-color: #CD853F; } /* ููุฌุฉ ุจุฑุชูุงููุฉ ุฏุงูุฆุฉ */
        .text-accent-1 { color: #CD853F; }
        .bg-accent-2 { background-color: #A0522D; } /* ููุฌุฉ ุฃุบูู / Terracotta */
        .text-accent-2 { color: #A0522D; }

        /* ุชุบููุฑ ุดุฑูุท ุงูุชูุฑูุฑ ูููุงุณุจ ุงูุซูู (ุชู ุงูุชุจุณูุท ูุชุฌูุจ ุฃุฎุทุงุก ุงููุชุบูุฑุงุช) */
        ::-webkit-scrollbar {
          width: 8px;
        }

        ::-webkit-scrollbar-track {
          background: #F8F4E8; /* Off-White for track */
        }

        ::-webkit-scrollbar-thumb {
          background: #CD853F; /* Accent-1 for thumb */
          border-radius: 4px;
        }

        /* ุชูุณูู ุดุฑูุท ุงูุชูุฑูุฑ ูู ุงููุถุน ุงูุฏุงูู */
        .dark ::-webkit-scrollbar-track {
          background: #382015; /* Darker track for dark mode */
        }
        .dark ::-webkit-scrollbar-thumb {
          background: #D2B48C; /* Coffee color for thumb in dark mode */
        }
      `}
    </style>
  );

  // ูููู ุดุฑูุท ุงูุชููู (Navigation Bar)
  const NavBar = () => {
    const [isMenuOpen, setIsMenuOpen] = useState(false);
    const navItems = [
      { label: 'ุงูุฑุฆูุณูุฉ', id: 'hero' },
      { label: 'ุนููุง', id: 'about' },
      { label: 'ุงูููุชุฌุงุช', id: 'products' },
    ];

    return (
      <header className="sticky top-0 z-50 shadow-md bg-off-white/90 dark:bg-brown-dark/90 backdrop-blur-sm border-b-2 border-accent-1/50 dark:border-off-white/10 transition-colors">
        <div className="max-w-7xl mx-auto flex items-center justify-between p-4">
          <h1
            className="text-2xl font-black text-accent-1 dark:text-accent-2 cursor-pointer hover:scale-105 transition-transform"
            onClick={() => setCurrentView('home')}
          >
            Y-Stitch
          </h1>

          <nav className="hidden md:flex items-center gap-6">
            {navItems.map(item => (
              <a
                key={item.id}
                onClick={() => scrollToSection(item.id)}
                className="text-coffee-dark dark:text-off-white font-semibold text-lg hover:text-accent-1 dark:hover:text-accent-2 transition-colors cursor-pointer"
              >
                {item.label}
              </a>
            ))}
          </nav>

          <div className="flex items-center gap-4">
            {/* ุฒุฑ ุชุจุฏูู ุงููุถุน (Light/Dark Mode) */}
            <button
              onClick={toggleDarkMode}
              className="p-3 rounded-full bg-coffee dark:bg-accent-1 text-brown-dark dark:text-off-white shadow-md hover:scale-110 transition-transform duration-300"
              aria-label={isDarkMode ? 'ุงูุชุจุฏูู ุฅูู ุงููุถุน ุงููุงุชุญ' : 'ุงูุชุจุฏูู ุฅูู ุงููุถุน ุงูุฏุงูู'}
            >
              {isDarkMode ? <Sun size={20} /> : <Moon size={20} />}
            </button>

            {/* ุฒุฑ ุงููุงุฆูุฉ ููููุงุชู (Mobile Menu) */}
            <button
              onClick={() => setIsMenuOpen(prev => !prev)}
              className="md:hidden p-2 rounded-lg bg-coffee dark:bg-accent-1 text-brown-dark dark:text-off-white transition-transform"
            >
              {isMenuOpen ? <X size={24} /> : <Menu size={24} />}
            </button>
          </div>
        </div>

        {/* ูุงุฆูุฉ ุงูููุงุชู ุงูููุณุฏูุฉ (Mobile Dropdown) */}
        {isMenuOpen && (
          <div className="md:hidden flex flex-col items-center py-4 space-y-3 bg-off-white dark:bg-brown-dark shadow-inner">
            {navItems.map(item => (
              <a
                key={item.id}
                onClick={() => {
                  scrollToSection(item.id);
                  setIsMenuOpen(false);
                }}
                className="w-full text-center text-coffee-dark dark:text-off-white font-semibold py-2 hover:bg-coffee/50 dark:hover:bg-accent-1/50 transition-colors cursor-pointer"
              >
                {item.label}
              </a>
            ))}
          </div>
        )}
      </header>
    );
  };

  // -----------------------------------------------------------------------
  // ุนุฑุถ ุงูุชุทุจูู ุงูุฑุฆูุณู (Main Render Logic)
  // -----------------------------------------------------------------------

  return (
    <>
      <CustomStyles />
      <div className="min-h-screen font-cairo" dir="rtl">
        <NavBar />

        <main className="pt-0">
          {currentView === 'home' ? (
            <>
              <HeroSection />
              <AboutSection />
              <ProductsIndexSection setCurrentView={setCurrentView} />
              {/* ** ุฅุถุงูุฉ ุตูุฏูู ูุดุงุฑูุฉ ุงูุฐูุฑู ููุง ** */}
              <MemoryPromptBox />
            </>
          ) : (
            // ุชู ุชูุฑูุฑ ุฏุงูุฉ openModal ููุง
            <ProductGallerySection 
              currentView={currentView} 
              setCurrentView={setCurrentView}
              openModal={openModal}
            />
          )}
        </main>

        <Footer />
      </div>
      
      {/* ** ุนุฑุถ ุงููุงูุฐุฉ ุงูููุจุฑุฉ ุฅุฐุง ูุงูุช ููุชูุญุฉ ** */}
      {isModalOpen && <LightboxModal imageUrl={selectedImage} onClose={closeModal} />}
    </>
  );
};

export default App;